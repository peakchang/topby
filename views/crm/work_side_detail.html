{% include "crm/db_head.html" %}

<body>
    <div class="container w-11/12 mt-2 rounded-md text-sm suit-font text-center">
        <form method="post">
            <table class="border-collapse border border-slate-400 w-full  rounded">


                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">현장명</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">간략설명</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <textarea name="" id="" rows="3"
                            class="text-gray-900 bg-gray-50 rounded-lg border border-gray-300 w-4/5"></textarea>
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">키워드</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">사이트명</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">사업명</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">분류</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">규모</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">전용면적</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">세대수</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">공급위치</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">입주예정</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">시공사</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">시행사</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <input type="text"
                            class="block p-2 w-4/5 text-gray-900 bg-gray-50 rounded-lg border border-gray-300 sm:text-xs mx-auto"
                            name="new_site_num" placeholder="">
                    </td>
                </tr>
                <tr>
                    <th class="border bg-slate-100 border-slate-300 py-1 text-center">특장점</th>
                    <td class="border border-slate-300 py-1 text-center">
                        <textarea name="" id="" rows="3"
                            class="text-gray-900 bg-gray-50 rounded-lg border border-gray-300 w-4/5"></textarea>
                    </td>
                </tr>
            </table>


            <div class="mt-3 text-center">
                <div class="text-xl">이미지 리스트</div>

                <!-- <div class="h-28 mb-3 rounded-lg border-dashed border-1 border-indigo-600 dropBox">
                    <div class="flex flex-col justify-center items-center h-full">
                        <span class="text-xl">이미지를 드래그해주세요</span>
                        <span class="text-4xl text-neutral-500"><i class="fa fa-plus-circle"
                                aria-hidden="true"></i></span>
                    </div>
                </div> -->


                <div class="drop-zone" style="height: 500px; width:500px; background-color:beige; ">또는 파일을 여기로 드래그하세요.
                </div>
                <input type="file" id="file" multiple>


                <!-- <button type="button" class="border rounded-lg px-4 py-2 bg-yellow-700 text-white">이미지 추가</button> -->
            </div>



            <h3>업로드된 파일</h3>
            <div id="preview">

            </div>
            <input type="file" id="file-input" multiple /><br>
            <span class="chkchk">체쿠체쿠</span></br>


            <button class="border rounded-lg py-2 text-white bg-cyan-700 text-xl w-3/5">등록하기</button>
        </form>
    </div>
</body>

<script>
    $('.testget').click(function (e) {
        console.log('aslidjfliasjdfljaf');
    })



    var $file = document.getElementById("file")
    var dropZone = document.querySelector(".drop-zone")

    var showFiles = function (files) {
        dropZone.innerHTML = ""
        for (var i = 0, len = files.length; i < len; i++) {
            dropZone.innerHTML += "<p>" + files[i].name + "</p>"
        }
    }

    var selectFile = function (files) {
        // input file 영역에 드랍된 파일들로 대체
        $file.files = files
        showFiles($file.files)

    }

    $file.addEventListener("change", function (e) {
        showFiles(e.target.files)
    })

    // 드래그한 파일이 최초로 진입했을 때
    dropZone.addEventListener("dragenter", function (e) {
        e.stopPropagation()
        e.preventDefault()

        console.log('파일이 진입함!!!');
        // toggleClass("dragenter")
    })

    // 드래그한 파일이 dropZone 영역을 벗어났을 때
    dropZone.addEventListener("dragleave", function (e) {
        e.stopPropagation()
        e.preventDefault()

        // toggleClass("dragleave")
    })

    // 드래그한 파일이 dropZone 영역에 머물러 있을 때
    dropZone.addEventListener("dragover", function (e) {
        e.stopPropagation()
        e.preventDefault()

        console.log('파일이 머무는중!!!');

        // toggleClass("dragover")
    })

    // 드래그한 파일이 드랍되었을 때

    var fileInput = document.querySelector('#file-input');
    var setFileList = Array.from(fileInput.files)
    dropZone.addEventListener("drop", function (e) {
        e.preventDefault()
        toggleClass("drop")
        var data = e.dataTransfer.files;
        for (let i = 0; i < data.length; i++) {
            const getData = data[i];
            console.log(getData);
            setFileList.push(getData)
        }
        console.log(setFileList);


        // setFileList.push(data.files)
        // console.log(setFileList);
        // var files = e.dataTransfer && e.dataTransfer.files
        // console.log(files)


        // if (files != null) {
        //     if (files.length < 1) {
        //         alert("폴더 업로드 불가")
        //         return
        //     }
        //     selectFile(files)
        // } else {
        //     alert("ERROR")
        // }

        // const fileInput = document.querySelector('#file-input');
        // const preview = document.querySelector('#preview');

        // console.log(fileInput);


    })



    const handler = {
        init() {
            const fileInput = document.querySelector('#file-input');
            const preview = document.querySelector('#preview');
            fileInput.addEventListener('change', () => {
                console.dir(fileInput)
                const files = Array.from(fileInput.files)
                console.log(files);
                files.forEach(file => {
                    preview.innerHTML += `
                        <p id="${file.lastModified}">
                            ${file.name}
                            <button data-index='${file.lastModified}' class='file-remove'>X</button>
                        </p>`;
                });
            });
        },

        removeFile: () => {
            document.addEventListener('click', (e) => {
                if (e.target.className !== 'file-remove') return;
                const removeTargetId = e.target.dataset.index;
                const removeTarget = document.getElementById(removeTargetId);
                const files = document.querySelector('#file-input').files;
                const dataTranster = new DataTransfer();

                // document.querySelector('#file-input').files =
                //             Array.from(files).filter(file => file.lastModified !== removeTarget);


                Array.from(files)
                    .filter(file => file.lastModified != removeTargetId)
                    .forEach(file => {
                        dataTranster.items.add(file);
                    });

                document.querySelector('#file-input').files = dataTranster.files;

                removeTarget.remove();
            })
        }
    }

    handler.init()
    handler.removeFile()


    $('.chkchk').click(function (e) {
        let fileInput = document.querySelector('#file-input');
        let setFileList = Array.from(fileInput.files)
        console.log(setFileList);
    })

</script>